# OpenSSH hardening for Ubuntu 24.04+ (OpenSSH 9.6+) with key-only auth
# Sources:
# - Ubuntu Server docs (OpenSSH server): https://documentation.ubuntu.com/server/how-to/security/openssh-server/
# - OpenSSH manpages: man sshd_config (https://manpages.ubuntu.com/manpages/noble/man5/sshd_config.5.html)
# - CIS Ubuntu 24.04 Benchmark (overview): https://www.cisecurity.org/benchmark/ubuntu_linux

# Authentication: enforce keys only (disable passwords/interactive prompts)
PubkeyAuthentication yes
PasswordAuthentication no

# Root login policy (disallow direct root logins)
PermitRootLogin no

# Conservative auth limits (tighter than defaults; reduce brute-force window)
MaxAuthTries 3

# Strong host key (ed25519 only; fast and secure on modern clients)
HostKey /etc/ssh/ssh_host_ed25519_key

# Reduce attack surface (disable rarely needed forwarding features on servers)
X11Forwarding no         # No GUI forwarding
AllowAgentForwarding no  # Prevent agent socket exposure
AllowTcpForwarding no    # Disable local/remote port forwarding

# Logging (VERBOSE records key fingerprint used for auth)
LogLevel VERBOSE